<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Job-Fit â€” Tailor your CV. Land interviews.</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/feather-icons"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    .fade-in { animation: fadeIn .4s ease both; }
    @keyframes fadeIn { from{opacity:0; transform: translateY(8px);} to{opacity:1; transform:none;} }

    .glass {
      backdrop-filter: blur(14px);
      background: rgba(255, 255, 255, 0.55);
    }
    .dark .glass { background: rgba(15, 23, 36, 0.55); }

    .dark-mode { background:#0b1220; color:#e6eef8; }
  </style>
</head>

<body class="font-sans bg-gray-50 text-gray-900">

  <!-- HEADER -->
  <header class="bg-white/80 backdrop-blur border-b sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">

      <!-- LOGO -->
      <a href="/" class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-blue-600 to-purple-600 
             flex items-center justify-center text-white font-bold shadow">
          CV
        </div>
        <div>
          <div class="text-2xl font-bold tracking-tight">Job-Fit</div>
          <div class="text-xs text-gray-500">Tailor your resume. Land interviews.</div>
        </div>
      </a>

      <!-- DESKTOP NAV -->
      <nav class="hidden md:flex items-center gap-5 text-sm" id="navBar">
        <a href="#how" class="hover:text-blue-600 transition">How it works</a>
        <a href="#features" class="hover:text-blue-600 transition">Features</a>

        <button id="loginBtn"
          class="px-4 py-2 rounded-lg border border-blue-600 text-blue-600 
                 hover:bg-blue-50 transition">
          Log in
        </button>

        <button id="darkToggle" 
          class="px-3 py-2 border rounded-md hover:bg-gray-100 transition">
          Dark
        </button>

        <a href="#upload-section"
          class="ml-2 px-4 py-2 bg-blue-600 text-white rounded-lg shadow 
                 hover:bg-blue-700 transition">
          Get Started
        </a>
      </nav>

      <!-- MOBILE MENU BUTTON -->
      <button id="mobileMenuBtn" class="md:hidden p-2 border rounded">
        <i data-feather="menu"></i>
      </button>
    </div>

    <!-- MOBILE NAV MENU -->
    <div id="mobileMenu" class="md:hidden hidden flex-col gap-4 px-6 pb-4 bg-white border-t">
      <a href="#how" class="block py-2">How it works</a>
      <a href="#features" class="block py-2">Features</a>

      <button id="mobileLoginBtn"
        class="w-full px-4 py-2 rounded-lg border border-blue-600 text-blue-600 
               hover:bg-blue-50 transition">
        Log in
      </button>

      <button id="mobileDarkToggle"
        class="px-3 py-2 border rounded-md hover:bg-gray-100 transition w-full">
        Dark
      </button>

      <a href="#upload-section"
        class="w-full inline-block text-center px-4 py-2 bg-blue-600 text-white rounded-lg shadow 
               hover:bg-blue-700 transition">
        Get Started
      </a>
    </div>
  </header>

  <!-- HERO SECTION -->
  <section class="relative bg-gradient-to-br from-blue-50 via-white to-purple-50 
                  dark:from-gray-900 dark:via-gray-800 dark:to-gray-900">

    <div class="max-w-7xl mx-auto px-6 py-16 lg:py-20 grid md:grid-cols-2 gap-14 items-center">

      <!-- TEXT -->
   <div class="fade-in">
        <h1 class="text-5xl font-extrabold leading-tight text-gray-900 dark:text-white">
          Make every job<br class="hidden sm:block" />
          application <span 
          class="bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
          count.</span>
        </h1>

        <p class="mt-5 text-lg text-gray-600 dark:text-gray-300 max-w-lg">
          Upload your CV and paste the job link.  
          Get an ATS-optimized version tailored to the exact job posting in seconds.
        </p>
      </div>

      <!-- UPLOAD CARD -->
      <div class="glass rounded-2xl shadow-xl p-6 sm:p-8 fade-in border border-white/30 dark:border-white/10">
        <h3 class="text-xl font-semibold text-center md:text-left">Upload & Tailor</h3>
        <p class="text-sm text-gray-600 dark:text-gray-300 mt-1 text-center md:text-left">
          Upload your CV. Paste job link. See optimized preview.
        </p>

        <form id="cvForm" class="mt-6 space-y-5" onsubmit="return false;">

          <!-- Upload -->
          <div>
            <label class="block text-sm font-semibold">Upload CV</label>
            <input id="file-upload" name="file" type="file" accept=".pdf,.doc,.docx"
              class="mt-2 block w-full text-sm border rounded-lg p-3 bg-white/80 shadow-sm 
                     focus:ring-2 focus:ring-blue-500" />

            <button id="upload-btn" type="button"
              class="mt-3 w-full px-4 py-2 bg-blue-600 text-white rounded-lg 
                    hover:bg-blue-700 transition">
              Upload File
            </button>

            <div id="progress-container" class="hidden w-full bg-gray-200 h-2 rounded-full mt-3">
              <div id="upload-progress" class="h-2 w-0 bg-green-500 rounded-full"></div>
            </div>

            <p id="file-info" class="text-sm text-gray-500 mt-2"></p>
          </div>

          <!-- Job URL -->
          <div>
            <label class="block text-sm font-semibold">Job Posting URL</label>
            <input id="job-link" type="url" placeholder="https://example.com/job/123"
              class="mt-2 block w-full p-3 border rounded-lg bg-white/80 shadow-sm 
                     focus:ring-2 focus:ring-blue-500" />
          </div>

          <!-- Optimize -->
          <button id="optimize-btn" type="submit"
            class="w-full px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 
                   transition disabled:opacity-50 disabled:cursor-not-allowed"
            disabled>
            Optimize my CV (preview)
          </button>
        </form>
      </div>

    </div>
  </section>

  <!-- PREVIEW SECTION -->
  <section id="upload-section" class="max-w-5xl mx-auto px-6 py-12">
    <div id="previewCard" 
         class="hidden bg-white dark:bg-gray-900 p-8 rounded-xl shadow-xl fade-in">
      <h3 class="font-bold text-lg">Optimized Preview</h3>
      <div id="previewContent" class="mt-4 text-sm text-gray-700 dark:text-gray-300"></div>

      <div class="mt-6 flex flex-col sm:flex-row gap-4">
        <button id="downloadBtn" 
          class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition">
          Download
        </button>

        <button id="editBtn" 
          class="px-4 py-2 border rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition">
          Edit further
        </button>
      </div>
    </div>
  </section>

  <script src="file.js"></script>

  <script>
    feather.replace();

    // DARK MODE (both desktop & mobile)
    const toggleDark = () => {
      document.documentElement.classList.toggle("dark");
      document.body.classList.toggle("dark-mode");
    };
    document.getElementById("darkToggle").onclick = toggleDark;
    document.getElementById("mobileDarkToggle").onclick = toggleDark;

    // MOBILE MENU
    document.getElementById("mobileMenuBtn").onclick = () => {
      document.getElementById("mobileMenu").classList.toggle("hidden");
    };

    // LOGIN CHECK
    async function checkLoginStatus() {
      try {
        const res = await fetch("/api/user");
        const data = await res.json();

        const desktopLogin = document.getElementById("loginBtn");
        const mobileLogin = document.getElementById("mobileLoginBtn");
        const nav = document.getElementById("navBar");

        if (data.loggedIn && data.user) {
          // Desktop Nav
          desktopLogin?.remove();

          const userDiv = document.createElement("div");
          userDiv.className = "flex items-center gap-2 cursor-pointer";

          userDiv.innerHTML = `
            <img src="${data.user.photo || ''}" class="w-8 h-8 rounded-full border" alt="Profile">
            <span class="text-sm">${data.user.name || 'User'}</span>
            <a href="/dashboard.html" class="text-sm text-blue-600 underline ml-2">Dashboard</a>
            <a href="/logout" class="text-xs text-red-500 underline ml-2">Logout</a>
          `;
          nav.appendChild(userDiv);

          // Mobile Nav
          mobileLogin.textContent = "Dashboard";
          mobileLogin.onclick = () => (window.location.href = "/dashboard.html");
        } else {
          // Not logged in
          desktopLogin.onclick = () => (window.location.href = "/auth/google");
          mobileLogin.onclick = () => (window.location.href = "/auth/google");
        }
      } catch (err) {
        console.error("Login check error", err);
      }
    }
    checkLoginStatus();
  </script>

</body>
</html>
